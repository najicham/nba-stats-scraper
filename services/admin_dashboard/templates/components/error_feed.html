<!-- Enhanced Error Feed with Categorization -->
<div x-data="{ showExpected: false }">
  <!-- Real Errors Section -->
  <div class="mb-6">
    <div class="flex items-center gap-2 mb-2">
      <span class="text-2xl">ðŸ”´</span>
      <h4 class="font-semibold text-red-600">Real Errors ({{ real_errors|length }})</h4>
    </div>
    <p class="text-sm text-gray-600 mb-3">These require immediate attention</p>

    {% if real_errors|length == 0 %}
    <div class="text-green-600 bg-green-50 p-3 rounded">
      âœ… No real errors detected
    </div>
    {% else %}
    <div class="space-y-2">
      {% for error in real_errors %}
      <div class="border-l-4 border-red-500 bg-red-50 p-3 rounded">
        <div class="flex justify-between items-start">
          <div>
            <span class="font-semibold">{{ error.processor_name }}</span>
            <span class="text-sm text-gray-500 ml-2">{{ error.data_date if error.data_date else 'N/A' }}</span>
          </div>
          <span class="text-xs text-gray-400">
            {% if error.started_at %}
              {{ error.started_at.strftime('%Y-%m-%d %H:%M') if error.started_at.strftime else error.started_at }}
            {% endif %}
          </span>
        </div>
        <p class="text-sm mt-1">{{ error.error_message if error.error_message else 'No error message' }}</p>
      </div>
      {% endfor %}
    </div>
    {% endif %}
  </div>

  <!-- Expected No-Data Section (Collapsible) -->
  <div>
    <button @click="showExpected = !showExpected"
            class="flex items-center gap-2 w-full text-left mb-2 hover:bg-gray-50 p-2 rounded">
      <span x-show="!showExpected">â–¶</span>
      <span x-show="showExpected">â–¼</span>
      <span class="text-xl">âœ…</span>
      <h4 class="font-semibold text-green-600">Expected No-Data ({{ expected_errors|length }})</h4>
    </button>
    <p class="text-sm text-gray-600 mb-3 ml-8">Filtered - No games scheduled on these dates</p>

    <div x-show="showExpected" class="ml-8 space-y-2" x-cloak>
      {% if expected_errors|length == 0 %}
      <div class="text-gray-500 text-sm italic">None detected</div>
      {% else %}
      <div class="space-y-1">
        {% for error in expected_errors[:5] %}
        <div class="bg-gray-50 p-2 rounded text-sm">
          <span class="font-medium">{{ error.processor_name }}</span>
          <span class="text-gray-500 ml-2">{{ error.data_date if error.data_date else 'N/A' }}</span>
        </div>
        {% endfor %}
        {% if expected_errors|length > 5 %}
        <div class="text-xs text-gray-500 italic">
          ... and {{ expected_errors|length - 5 }} more
        </div>
        {% endif %}
      </div>
      {% endif %}
    </div>
  </div>

  <!-- Noise Reduction Metric -->
  <div class="mt-4 p-3 bg-blue-50 rounded">
    <div class="flex items-center gap-2">
      <span class="text-blue-600 font-semibold">Alert Noise Reduction:</span>
      <span class="text-2xl font-bold text-blue-700">{{ noise_reduction }}</span>
      <span class="text-sm text-gray-600">false positives filtered</span>
    </div>
  </div>
</div>
