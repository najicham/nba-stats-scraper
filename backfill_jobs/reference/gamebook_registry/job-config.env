# File: backfill_jobs/reference/gamebook_registry/job-config.env
# Description: Cloud Run job configuration for NBA Gamebook Registry backfill with Email Alerting

# CRITICAL: Use unique name - gamebook-specific to distinguish from roster processor
JOB_NAME="gamebook-registry-processor-backfill"
JOB_SCRIPT="backfill_jobs/reference/gamebook_registry/gamebook_registry_reference_backfill.py"
JOB_DESCRIPTION="Build NBA Players Registry from historical NBA.com gamebook data with Email Alerting"

# Resources - Gamebook registry building is memory intensive
TASK_TIMEOUT="7200"  # 2 hours for full backfill (4+ seasons of data)
MEMORY="8Gi"         # High memory for large dataset processing and Universal ID resolution
CPU="4"              # Multi-core for parallel processing and BigQuery operations

# Processing Configuration
STRATEGY="merge"                          # Default to safe MERGE strategy
ENABLE_NAME_CHANGE_DETECTION="false"     # Disabled by default for backfill performance
TEST_MODE="false"                         # Production mode by default

# Data Source
BUCKET_NAME="nba-scraped-data"
DATA_SOURCE="nba_raw.nbac_gamebook_player_stats"  # Specific to gamebook data

# Defaults
SEASON=""            # Will use current season if not specified
ALL_SEASONS="false"  # Set to true for full historical backfill

# Universal Player ID Integration
UNIVERSAL_ID_ENABLED="true"              # Always enabled for consistent player identification
ALIAS_RESOLUTION_ENABLED="true"         # Enable player alias resolution

# Safety and Monitoring
CONFIRM_FULL_DELETE="false"              # Safety flag for REPLACE strategy
MAX_RETRY_ATTEMPTS="3"                   # Retry failed operations
LOG_LEVEL="INFO"                         # Logging verbosity

# Email Alerting Thresholds (can be overridden in .env file)
EMAIL_ALERT_UNRESOLVED_COUNT_THRESHOLD="50"      # Alert if >50 unresolved players found
EMAIL_ALERT_SUCCESS_RATE_THRESHOLD="90.0"        # Alert if <90% processing success rate
EMAIL_ALERT_MAX_PROCESSING_TIME="30"             # Alert if processing takes >30 minutes
EMAIL_ALERT_NEW_PLAYERS_THRESHOLD="20"           # Alert if >20 new players discovered